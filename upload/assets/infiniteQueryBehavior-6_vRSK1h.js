import{e as T,g as j,i as E}from "./removable-CGh8wCEh.js";function S(a){return{onFetch:(e, t)=>{var p,y,v,F,b;const n=e.options,d=(v=(y=(p=e.fetchOptions)==null?void 0:p.meta)==null?void 0:y.fetchMore)==null?void 0:v.direction,c=((F=e.state.data)==null?void 0:F.pages)||[],m=((b=e.state.data)==null?void 0:b.pageParams)||[];let l={pages:[],pageParams:[]},g=0;const h=async()=>{let i=!1;const u= r=>{Object.defineProperty(r,"signal",{enumerable:!0,get:()=>(e.signal.aborted?i=!0:e.signal.addEventListener("abort",()=>{i=!0}),e.signal)})},N=T(e.options,e.fetchOptions),w=async(r, s, o)=>{if(i)return Promise.reject();if(s==null&&r.pages.length)return Promise.resolve(r);const P={client:e.client,queryKey:e.queryKey,pageParam:s,direction:o?"backward":"forward",meta:e.options.meta};u(P);const O=await N(P),{maxPages:q}=e.options,K=o?j:E;return{pages:K(r.pages,O,q),pageParams:K(r.pageParams,s,q)}};if(d&&c.length){const r=d==="backward",s=r?k:f,o={pages:c,pageParams:m},P=s(n,o);l=await w(o,P,r)}else{const r=a??c.length;do{const s=g===0?m[0]??n.initialPageParam:f(n,l);if(g>0&&s==null)break;l=await w(l,s),g++}while(g<r)}return l};e.options.persister?e.fetchFn=()=>{var i,u;return(u=(i=e.options).persister)==null?void 0:u.call(i,h,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=h}}}function f(a, {pages:e,pageParams:t}){const n=e.length-1;return e.length>0?a.getNextPageParam(e[n],e,t[n],t):void 0}function k(a, {pages:e,pageParams:t}){var n;return e.length>0?(n=a.getPreviousPageParam)==null?void 0:n.call(a,e[0],e,t[0],t):void 0}function B(a, e){return e?f(a,e)!=null:!1}function C(a, e){return!e||!a.getPreviousPageParam?!1:k(a,e)!=null}export{B as a,C as h,S as i};
