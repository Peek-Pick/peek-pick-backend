import{w as g}from "./with-props-JNWkkrjn.js";import{p as h,a as p}from "./chunk-D4RADZKF-DdSvw7tX.js";import{j as e}from "./jsx-runtime-D_zvdyIk.js";import{R as j}from "./rating-s5hnHQfB.js";import{R as v,a as w}from "./reviewLoading-C78wslp8.js";import{F as b,a as y}from "./FloatingActionButtons-3zuONfQ9.js";import{u as f}from "./useTranslation-DnilsLqi.js";import{u as N}from "./useQuery-CxabGwVz.js";import{u as R}from "./useInfiniteQuery-BFmOQqc-.js";import{g as L,e as I}from "./reviewAPI-zRekXALF.js";import"./index-Druiat5n.js";import"./createLucideIcon-Cyt6UY_L.js";import"./i18nInstance-CHFDjdcJ.js";import"./useBaseQuery-BTSvK_Q6.js";import"./removable-CGh8wCEh.js";import"./query-CjmfnAM3.js";import"./QueryClientProvider--V26__jT.js";import"./infiniteQueryBehavior-6_vRSK1h.js";import"./axiosInstance-CCaw23o5.js";import"./index-xsH4HHeE.js";function k({reviewCount:m,reviewList:c,fetchNextPage:i,hasNextPage:s,isFetchingNextPage:a,isLoading:d,isError:x}){const{t:r}=f(),o=h(),n=p.useRef(null);return p.useEffect(()=>{if(!n.current||!s)return;const t=new IntersectionObserver(([l])=>{l.isIntersecting&&!a&&i().then()},{rootMargin:"100px",threshold:1});return t.observe(n.current),()=>t.disconnect()},[i,s,a]),d?e.jsx(v,{}):x?e.jsx("p",{className:"text-center p-4 text-red-500 text-base sm:text-lg",children:r("reviewLoadError")}):e.jsx("div",{children:e.jsx("section",{className:"relative",children:e.jsx("div",{className:"max-w-3xl mx-auto bg-white rounded-2xl shadow px-4 pt-4 pb-6 relative space-y-4",children:e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex justify-between items-center mb-4 mt-1.5",children:e.jsxs("h2",{className:"flex items-center gap-1 text-xl font-bold  select-none leading-none",children:[e.jsxs("span",{className:"leading-none text-black ml-1.5",children:[r("totalReview"),": "]}),e.jsx("span",{className:"text-yellow-500 font-normal ml-2",children:m})]})}),e.jsx("ul",{className:"flex flex-col gap-5",children:c.map(t=>e.jsxs("div",{className:"p-4 bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition cursor-pointer",children:[e.jsx("div",{className:"flex sm:items-center flex-col min-[400px]:flex-row justify-between gap-5 mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:`https://myapp.peek-pick.click${t.imageThumbUrl}`,className:"w-20 h-20 rounded-lg object-cover border-2 border-gray-100",alt:"Product Info"}),e.jsx("h6",{className:"font-semibold text-base leading-8 text-gray-600",children:t.name})]})}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex items-center gap-2",children:Array.from({length:5}).map((l, u)=>e.jsx(j,{filled:u<t.score},u))}),e.jsx("p",{className:"font-normal text-sm sm:text-sm text-gray-400",children:new Date(t.regDate).toLocaleDateString()})]}),e.jsx("p",{className:"line-clamp-5 font-normal text-sm sm:text-sm leading-6 text-gray-600 max-xl:text-justify mb-1",style:{whiteSpace:"pre-line"},children:t.comment}),e.jsxs("div",{className:"flex flex-col-2 sm:flex-row items-stretch justify-end gap-4 mt-4 w-full",children:[e.jsx("button",{type:"button",onClick:()=>o(`/reviews/modify/${t.reviewId}`),className:"w-full sm:flex-1 px-4 py-2 text-sm sm:text-sm rounded-lg bg-emerald-50 text-emerald-600 cursor-pointer font-medium text-center transition-all duration-300 hover:bg-emerald-100 hover:text-emerald-700 min-w-0",children:r("updateReviewButton")}),e.jsx("button",{type:"button",onClick:()=>o(`/reviews/${t.reviewId}`),className:"w-full sm:flex-1 px-4 py-2 text-sm sm:text-sm rounded-lg bg-emerald-50 text-emerald-600 cursor-pointer font-medium text-center transition-all duration-300 hover:bg-emerald-100 hover:text-emerald-700 min-w-0",children:r("detailReviewButton")})]})]},t.reviewId))}),e.jsx(b,{}),e.jsx(y,{where:"/mypage"}),s&&e.jsx("div",{ref:n,className:"h-1"}),a&&e.jsx(w,{})]})})})})}function C(){const{i18n:m}=f(),c=m.language,{data:i}=N({queryKey:["userReviewCount"],queryFn:()=>L()}),{data:s,fetchNextPage:a,hasNextPage:d,isFetchingNextPage:x,isLoading:r,isError:o}=R({queryKey:["userReviews"],queryFn:({pageParam:t})=>I(t,c),initialPageParam:0,getNextPageParam: t=>{const l=t.data.pageable.pageNumber;return t.data.last?void 0:l+1}}),n=(s==null?void 0:s.pages.flatMap(t=>t.data.content))??[];return e.jsx("div",{children:e.jsx(k,{reviewCount:i,reviewList:n,fetchNextPage:a,hasNextPage:d,isFetchingNextPage:x,isLoading:r,isError:o})})}const V=g(C);export{V as default};
