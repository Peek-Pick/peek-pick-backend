import{w as b}from "./with-props-JNWkkrjn.js";import{w as g,p as y,a as s}from "./chunk-D4RADZKF-DdSvw7tX.js";import{j as t}from "./jsx-runtime-D_zvdyIk.js";import{u as N}from "./QueryClientProvider--V26__jT.js";import{u as c}from "./useMutation-iBKtBQ4J.js";import{N as w}from "./formComponent-fX_i-ljW.js";import{a as j,b as v,u as C,d as I}from "./adminNoticesAPI-BoOoJ07k.js";import"./sweetalert2.esm.all-9Qm2jZ7z.js";import"./mutation-CruqbX-z.js";import"./removable-CGh8wCEh.js";import"./index-DP0VIuDs.js";import"./axiosInstance-CCaw23o5.js";import"./index-xsH4HHeE.js";const B=b(function(){const{id:n}=g(),o=y(),[a,l]=s.useState(null),[r,u]=s.useState(null),m=N();s.useEffect(()=>{n&&j(Number(n)).then(e=>l(e))},[n]);const d=c({mutationFn: e=>v(Number(n),e).then(i=>i.data),onSuccess:async e=>{await m.invalidateQueries({queryKey:["admin-notices"],exact:!1}),alert("수정 완료되었습니다."),r&&e.noticeId?C(e.noticeId,r).then(()=>o(`/admin/notices/${e.noticeId}`)).catch(i=>{console.error(i),alert("이미지 업로드에 실패했습니다."),o(`/admin/notices/${e.noticeId}`)}):o(`/admin/notices/${e.noticeId}`)},onError: e=>{console.error(e),alert("수정에 실패했습니다.")}}),p=c({mutationFn:()=>I(Number(n)),onSuccess:()=>o("/admin/notices/list")});if(!a)return null;const f=(e, i)=>{window.confirm("정말 수정하시겠습니까?")&&(u(i??null),d.mutate(e))},x=()=>{confirm("정말 삭제하시겠습니까?")&&p.mutate(void 0,{onSuccess:async()=>{await m.invalidateQueries({queryKey:["admin-notices"],exact:!1})},onError: e=>{console.error(e)}})},h=()=>o(`/admin/notices/${n}`);return t.jsxs("div",{className:"p-6 max-w-3xl mx-auto",children:[t.jsx("h1",{className:"text-2xl font-bold mb-4",children:"공지사항 수정"}),t.jsx(w,{initialData:a,submitLabel:"수정",onSubmit:f,extraActions:t.jsxs(t.Fragment,{children:[t.jsx("button",{type:"button",onClick:h,className:"flex items-center gap-1 rounded-md px-4 py-2 text-sm font-medium shadow-sm transition bg-gray-200 hover:bg-gray-300",children:"취소"}),t.jsx("button",{type:"button",onClick:x,className:"flex items-center gap-1 rounded-md px-4 py-2 text-sm font-medium text-red-600 bg-red-200 shadow-sm hover:bg-red-300 transition",children:"삭제"})]})})]})});export{B as default};
