import{w as x}from "./with-props-JNWkkrjn.js";import{p as I,v as h,a as e}from "./chunk-D4RADZKF-DdSvw7tX.js";import{j as r}from "./jsx-runtime-D_zvdyIk.js";import{u as E}from "./useInfiniteQuery-BFmOQqc-.js";import{L as R}from "./listComponent-C0Baj83L.js";import{b as T}from "./myPageAPI-BH0myYQf.js";import{B as N,F as S}from "./FloatingActionButtons-3zuONfQ9.js";import{u as F}from "./useTranslation-DnilsLqi.js";import"./useBaseQuery-BTSvK_Q6.js";import"./removable-CGh8wCEh.js";import"./query-CjmfnAM3.js";import"./QueryClientProvider--V26__jT.js";import"./infiniteQueryBehavior-6_vRSK1h.js";import"./iconify-uWM87A7v.js";import"./productLoading-CtBxAkDp.js";import"./index-Druiat5n.js";import"./axiosInstance-CCaw23o5.js";import"./index-xsH4HHeE.js";import"./createLucideIcon-Cyt6UY_L.js";import"./i18nInstance-CHFDjdcJ.js";const s="favoritesPageScrollY",W=x(function(){const{t:j,i18n:f}=F(),l=f.language,c=12,p=I(),i=h(),a=e.useRef(!1),m=e.useRef(!0);e.useLayoutEffect(()=>{var o;return"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual"),m.current&&((((o=performance.getEntriesByType("navigation").at(-1))==null?void 0:o.type)??"")==="reload"&&(window.scrollTo(0,0),sessionStorage.removeItem(s),a.current=!1),m.current=!1),()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="auto")}},[]),e.useEffect(()=>{i!=="POP"&&(sessionStorage.removeItem(s),a.current=!1)},[i]);const{data:n,fetchNextPage:d,hasNextPage:g,isFetchingNextPage:v,isLoading:w,isError:y}=E({queryKey:["favoritesCursor",c],queryFn:async({pageParam:o})=>{const t=o;return await T(c,t==null?void 0:t.lastModDate,t==null?void 0:t.lastProductId,l)},getNextPageParam: o=>{const t=o.content.at(-1);if(!(!t||!t.modDate||!t.productId||!o.hasNext))return{lastModDate:t.modDate,lastProductId:t.productId}},initialPageParam:void 0}),P= o=>{sessionStorage.setItem(s,JSON.stringify({scrollY:window.scrollY,fromDetail:!0})),p(`/products/${o}`,{state:{fromDetail:!0}})};return e.useEffect(()=>{if(i==="POP"&&n&&!a.current){const o=sessionStorage.getItem(s);if(o){const{scrollY:t,fromDetail:u}=JSON.parse(o);u&&(window.scrollTo(0,t),requestAnimationFrame(()=>window.scrollTo(0,t))),sessionStorage.removeItem(s)}a.current=!0}},[i,n]),r.jsxs(r.Fragment,{children:[r.jsx(R,{products:n?n.pages.flatMap(o=>o.content):[],fetchNextPage:d,hasNextPage:g,isFetchingNextPage:v,isLoading:w,isError:y,onItemClick:P}),r.jsx(N,{}),r.jsx(S,{})]})});export{W as default};
