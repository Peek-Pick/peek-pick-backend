import{w as D}from "./with-props-JNWkkrjn.js";import{p as P,s as S,a as o,t as C}from "./chunk-D4RADZKF-DdSvw7tX.js";import{j as e}from "./jsx-runtime-D_zvdyIk.js";import{u as I}from "./useQuery-CxabGwVz.js";import{F as L,i as k}from "./index-DP0VIuDs.js";import{l as q}from "./inquiriesAPI-gt-yzMzF.js";import{P as E}from "./PaginationComponent-CiWrhgCU.js";import{L as $}from "./loadingComponent-BmsJ8g5Y.js";import{I as A,a as W}from "./inquiry-AmjiLZEt.js";import"./useBaseQuery-BTSvK_Q6.js";import"./removable-CGh8wCEh.js";import"./query-CjmfnAM3.js";import"./QueryClientProvider--V26__jT.js";import"./axiosInstance-CCaw23o5.js";import"./index-xsH4HHeE.js";import"./chevron-left-i71DKoJD.js";import"./createLucideIcon-Cyt6UY_L.js";import"./chevron-right-WLYf1NvF.js";import"./index-Druiat5n.js";function R({items:i}){const y=P(),c=S(),g= t=>{const n=c.search;y(`/admin/inquiries/${t}${n}`)},d= t=>{const n=new Date(t),r= l=>l.toString().padStart(2,"0");return`${n.getFullYear()}/${r(n.getMonth()+1)}/${r(n.getDate())} ${r(n.getHours())}:${r(n.getMinutes())}`},p=[...i].sort((t, n)=>n.inquiryId-t.inquiryId),u=["#","유형","내용","작성일","수정일","닉네임","상태","삭제여부"];return e.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white shadow",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm divide-y divide-gray-200 table-fixed",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-16"}),e.jsx("col",{className:"w-24"}),e.jsx("col",{className:"w-48"}),e.jsx("col",{className:"w-36"}),e.jsx("col",{className:"w-36"}),e.jsx("col",{className:"w-32"}),e.jsx("col",{className:"w-24"}),e.jsx("col",{className:"w-24"})]}),e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:u.map(t=>e.jsx("th",{className:"px-4 py-2 text-left text-xs font-normal text-gray-500 uppercase tracking-wider whitespace-nowrap",children:t},t))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-4 text-center text-gray-500",children:"조회된 문의가 없습니다."})}):p.map(t=>{var x;const n=((x=A.find(m=>m.value===t.type))==null?void 0:x.label)??t.type,r=W[t.status]??t.status,l=new Date(t.regDate).getTime()===new Date(t.modDate).getTime();return e.jsxs("tr",{onClick:()=>g(t.inquiryId),className:"hover:bg-gray-100 cursor-pointer text-gray-800",children:[e.jsx("td",{className:"px-4 py-3.5",children:t.inquiryId}),e.jsx("td",{className:"px-4 py-3.5",children:n}),e.jsxs("td",{className:"px-4 py-3.5 truncate max-w-[12rem]",children:[" ",t.content," "]}),e.jsx("td",{className:"px-4 py-3.5",children:d(t.regDate)}),e.jsx("td",{className:"px-4 py-3.5",children:l?"":d(t.modDate)}),e.jsx("td",{className:"px-4 py-3.5 truncate max-w-[128px]",children:t.userNickname}),e.jsx("td",{className:"px-4 py-3.5",children:e.jsx("div",{className:`inline-block px-2 py-1 text-xs font-semibold rounded-full whitespace-nowrap truncate ${t.status==="PENDING"?"bg-gray-200 text-gray-700":"bg-green-200 text-green-800"}`,children:r})}),e.jsx("td",{className:"px-4 py-3.5",children:t.isDelete&&e.jsx("span",{className:"text-red-500 font-semibold",children:"삭제됨"})})]},t.inquiryId)})})]})})})}function F({category:i,setCategory:y,keyword:c,setKeyword:g,waitingAnswerOnly:d,setWaitingAnswerOnly:p,includeDeleted:u,setIncludeDeleted:t,onSearch:n}){const[r,l]=o.useState(i),[x,m]=o.useState(c),w=P(),[f]=C();o.useEffect(()=>l(i),[i]),o.useEffect(()=>m(c),[c]);const j= s=>{const a=new URLSearchParams(f);s(a),w(`?${a.toString()}`,{replace:!1})},N=()=>{y(r),g(x),j(s=>{s.set("category",r),s.set("keyword",x),s.set("page","0")}),n()},b= s=>{p(s),j(a=>{s?a.set("isWaiting","true"):a.delete("isWaiting"),a.set("page","0")}),n()},v= s=>{t(s),j(a=>{s?a.set("includeDeleted","true"):a.delete("includeDeleted"),a.set("page","0")}),n()};return e.jsxs("div",{className:"flex justify-between items-center mb-2 text-sm bg-white p-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{value:r,onChange: s=>l(s.target.value),className:"border border-gray-300 rounded-lg px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"전체"}),e.jsx("option",{value:"content",children:"내용"}),e.jsx("option",{value:"writer",children:"닉네임"}),e.jsx("option",{value:"inquiryId",children:"문의번호"})]}),e.jsx("input",{type:"text",value:x,onChange: s=>m(s.target.value),placeholder:"키워드를 입력하세요",className:"border border-gray-300 rounded-lg px-4 py-1.5 w-64 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{onClick:N,className:"bg-blue-600 text-white px-5 py-1.5 rounded-lg hover:bg-blue-700 transition",children:"검색"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-1 text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:d,onChange: s=>b(s.target.checked)}),"답변 대기만 보기"]}),e.jsxs("label",{className:"flex items-center gap-1 text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:u,onChange: s=>v(s.target.checked)}),"삭제된 문의 보기"]})]})]})}function T(){const[i,y]=C(),[c,g]=o.useState(0),[d,p]=o.useState(""),[u,t]=o.useState("all"),[n,r]=o.useState(!1),[l,x]=o.useState(!1);o.useEffect(()=>{g(Math.max(0,Number(i.get("page"))||0)),p(i.get("keyword")||""),t(i.get("category")||"all"),r(i.get("includeDeleted")==="true"),x(i.get("isWaiting")==="true")},[i]);const m= a=>{const h=new URLSearchParams;h.set("page",String(a??c)),u!=="all"&&h.set("category",u),d.trim()!==""&&h.set("keyword",d.trim()),n&&h.set("includeDeleted","true"),l&&h.set("status","PENDING"),y(h)},w=o.useMemo(()=>({page:c,keyword:d.trim()||void 0,category:u!=="all"?u:void 0,includeDeleted:n,isWaiting:l||void 0}),[c,d,u,n,l]),{data:f,isLoading:j,isError:N}=I({queryKey:["admin-inquiries",w],queryFn:()=>q(w).then(a=>a.data)}),b= a=>{g(a),m(a)},v= a=>{x(a),g(0),m(0)},s= a=>{r(a),g(0),m(0)};return j?e.jsx($,{isLoading:!0}):N||!f?e.jsx("div",{className:"p-4 text-red-500",children:"데이터를 불러오지 못했습니다."}):e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(L,{icon:k}),"문의사항 관리"]}),e.jsx(F,{category:u,setCategory:t,keyword:d,setKeyword:p,waitingAnswerOnly:l,setWaitingAnswerOnly:v,includeDeleted:n,setIncludeDeleted:s,onSearch:()=>g(0)}),e.jsx(R,{items:f.content}),e.jsx(E,{currentPage:c,totalPages:f.totalPages,onPageChange:b,maxPageButtons:10})]})}const ne=D(T);export{ne as default};
