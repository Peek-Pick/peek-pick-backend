import{w as y}from "./with-props-JNWkkrjn.js";import{w,p as P,a as r}from "./chunk-D4RADZKF-DdSvw7tX.js";import{j as o}from "./jsx-runtime-D_zvdyIk.js";import{u as j}from "./useQuery-CxabGwVz.js";import{u as v}from "./useMutation-iBKtBQ4J.js";import{P as D}from "./formComponent-qR9YGr4b.js";import{u as N,g as S}from "./adminProductsAPI-U5v2Fkh_.js";import{P as F}from "./productLoading-CtBxAkDp.js";import"./useBaseQuery-BTSvK_Q6.js";import"./removable-CGh8wCEh.js";import"./query-CjmfnAM3.js";import"./QueryClientProvider--V26__jT.js";import"./mutation-CruqbX-z.js";import"./index-DP0VIuDs.js";import"./axiosInstance-CCaw23o5.js";import"./index-xsH4HHeE.js";import"./index-Druiat5n.js";const J=y(function(){const{id:n}=w(),a=P(),i=Number(n),[m,p]=r.useState(null),[g,u]=r.useState("이미지 필수"),[d,l]=r.useState(!1),[c,f]=r.useState(),{data:e,isLoading:b}=j({queryKey:["adminProductDetail",i],queryFn:()=>S(i),enabled:!!n});r.useEffect(()=>{var s;if(!e)return;f({name:e.name,barcode:e.barcode,description:e.description??"",category:e.category??"",volume:e.volume??"",ingredients:e.ingredients??"",allergens:e.allergens??"",nutrition:e.nutrition??""}),l(e.isDelete??!1);const t=(s=e.imgUrl)==null?void 0:s.split("/").pop();u(t??"이미지 필수")},[e]);const x=v({mutationFn: t=>N(i,t,m??void 0,d),onSuccess: t=>{alert("상품이 성공적으로 수정되었습니다."),a(`/admin/products/${t.productId}`)},onError: t=>{console.error(t),alert("수정 중 오류 발생: "+t.message)}}),h= t=>{if(!m&&!(e!=null&&e.imgUrl)){alert("이미지를 반드시 첨부해야 합니다.");return}window.confirm("정말 수정하시겠습니까?")&&x.mutate(t)};return b||!c?o.jsx(F,{}):o.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6 max-w-4xl mx-auto",children:[o.jsx("h2",{className:"text-xl font-bold mb-6 border-b pb-2",children:"상품 수정"}),o.jsx(D,{initial:c,onSubmit:h,onFileChange: t=>{p(t),u((t==null?void 0:t.name)??"이미지 필수")},fileLabel:g,showDeleteCheckbox:!0,isDelete:d,onToggleDelete:()=>l(t=>!t)}),o.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[o.jsx("button",{type:"button",onClick:()=>a(-1),className:"flex items-center gap-1 rounded-md px-4 py-2 text-sm font-medium shadow-sm transition bg-gray-200 hover:bg-gray-300",children:"취소"}),o.jsx("button",{type:"button",onClick:()=>{const t=document.querySelector("form");t&&t.requestSubmit()},className:"flex items-center gap-1 rounded-md px-4 py-2 text-sm font-medium shadow-sm transition bg-blue-600 text-white hover:bg-blue-700",children:"수정"})]})]})});export{J as default};
