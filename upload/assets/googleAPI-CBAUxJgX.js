import{t as u,p,a as c}from "./chunk-D4RADZKF-DdSvw7tX.js";import{j as s}from "./jsx-runtime-D_zvdyIk.js";import{a as m}from "./index-xsH4HHeE.js";import{S as g}from "./sweetalert2.esm.all-9Qm2jZ7z.js";import{K as d}from "./index-Druiat5n.js";const f=()=>s.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white z-50",children:s.jsx("div",{className:"w-70 h-100",children:s.jsx(d,{src:"/loading/lottie_login.lottie",loop:!0,autoplay:!0,speed:1.5})})}),h="https://myapp.peek-pick.click/api/v1",S=()=>`https://accounts.google.com/o/oauth2/v2/auth?${new URLSearchParams({client_id:"437911674528-fjjj26o3oe1o6m704rq97giu9u3mi01u.apps.googleusercontent.com",redirect_uri:"https://www.peek-pick.click/signup/google",response_type:"code",scope:"email profile",access_type:"offline",prompt:"consent"}).toString()}`,k=()=>{const[n]=u(),o=p(),[r,l]=c.useState(!0),i=n.get("code");return c.useEffect(()=>{if(!i){o("/login");return}m.get(`${h}/auth/login/google?code=${i}`,{withCredentials:!0}).then(e=>{var t,a;e.status===200&&((t=e.data)!=null&&t.isNew)?o("/signup/profile",{state:{email:e.data.email}}):e.status===200&&((a=e.data)!=null&&a.redirectUrl)?window.location.href=e.data.redirectUrl:o("/login")}).catch(async e=>{var a;const t=e.response;(t==null?void 0:t.status)===403&&((a=t==null?void 0:t.data)!=null&&a.banned)?(await g.fire({icon:"warning",title:"접근 제한",html:`<b>${t.data.banUntil}</b>까지 로그인할 수 없습니다.`,confirmButtonText:"확인",customClass:{popup:"custom-popup",title:"custom-title",actions:"custom-actions",confirmButton:"custom-confirm-button"}}),o("/main")):(console.error("SNS 로그인 실패",e),o("/login"))}).finally(()=>l(!1))},[i,o]),r?s.jsx(f,{}):null};export{k as G,f as L,S as g};
