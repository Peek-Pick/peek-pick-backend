import{w as C}from "./with-props-JNWkkrjn.js";import{a as c,s as M,p as A}from "./chunk-D4RADZKF-DdSvw7tX.js";import{j as e}from "./jsx-runtime-D_zvdyIk.js";import{u as L}from "./signupContext-DhL0Xc1z.js";import{c as T}from "./countryUtils-CZtoRm9G.js";import{S as F}from "./signupStepperHeader-DU-4b-_Q.js";import{u as P}from "./useNicknameChecker-BYXU2R2N.js";import{C as q}from "./signupAPI-CKOHqB1c.js";import{c as D}from "./createLucideIcon-Cyt6UY_L.js";import"./index-xsH4HHeE.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],B=D("sparkles",U),b=["Brave","Happy","Clever","Bright","Silly","Lively","Gentle","Shy","Quick","Bold"],v=["Tiger","Penguin","Fox","Koala","Panda","Magpie","Otter","Sparrow","Giant","Eagle","Seagull"],G=()=>{const s=b[Math.floor(Math.random()*b.length)],a=v[Math.floor(Math.random()*v.length)],n=Math.floor(Math.random()*90)+10;return`${s}${a}${n}`};function O(){return{generateUniqueNickname:c.useCallback(async()=>{let a=0;for(;a<20;){const n=G(),{exists:m}=await q(n);if(!m)return n;a++}throw new Error("Failed to generate unique nickname after 20 attempts.")},[])}}function $(){const{nickname:s,setNickname:a,birthDate:n,setBirthDate:m,gender:l,setGender:y,nationality:i,setNationality:j,email:k,setEmail:u,setPassword:x}=L(),{isChecking:N,isAvailable:r,error:p}=P(s),{generateUniqueNickname:w}=O(),[h,g]=c.useState(!1);c.useEffect(()=>{console.log("isAvailable:",r),console.log("gender:",l),console.log("nationality:",i),g(!!(r&&l!=="DEFAULT"&&i!=="DEFAULT"))},[r,l,i]);const f=M(),d=A();c.useEffect(()=>{var o;const t=(o=f.state)==null?void 0:o.email;t&&(u(t),x(null)),!t&&!k&&d("/access-denied",{replace:!0})},[f.state,u,x,d]);const S=async()=>{const t=await w();a(t)},E=t=>{t.preventDefault(),r&&d("/signup/tag")};return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-r from-yellow-200 to-green-300 px-4",children:[e.jsx("div",{className:"w-full px-4",children:e.jsx(F,{currentStep:2})}),e.jsxs("div",{className:"mb-20 w-full max-w-md bg-white p-6 rounded-xl shadow-md",children:[e.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Tell us more about you"}),e.jsxs("form",{className:"space-y-4",onSubmit:E,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Nickname"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:s,onChange:t=>a(t.target.value),className:"w-full px-4 pr-10 py-3 mt-1 rounded-[15px] border border-gray-300 text-sm",placeholder:"Enter your nickname",required:!0}),e.jsx("button",{type:"button",onClick:S,className:"absolute top-1/2 right-3 transform -translate-y-1/2 text-yellow-400 hover:text-yellow-500 active:text-yellow-600",title:"Generate nickname",children:e.jsx(B,{size:18})})]}),N&&e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Checking..."}),p&&e.jsx("p",{className:"text-red-500 text-sm mt-1 ml-1",children:p}),r&&e.jsx("p",{className:"text-green-500 text-sm mt-1 ml-1",children:"The nickname is available."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Birthdate"}),e.jsx("input",{type:"date",value:n,onChange:t=>m(t.target.value),className:"w-full px-4 py-3 mt-1 rounded-[15px] border border-gray-300 text-sm",required:!0,max:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Gender"}),e.jsxs("select",{value:l,onChange:t=>y(t.target.value),className:"w-full px-4 py-3 mt-1 rounded-[15px] border border-gray-300 text-sm",required:!0,children:[e.jsx("option",{value:"DEFAULT",disabled:!0,children:"Select gender"}),e.jsx("option",{value:"MALE",children:"Male"}),e.jsx("option",{value:"FEMALE",children:"Female"}),e.jsx("option",{value:"OTHER",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Nationality"}),e.jsxs("select",{value:i,onChange:t=>j(t.target.value),className:"w-full px-4 py-3 mt-1 rounded-[15px] border border-gray-300 text-sm",required:!0,children:[e.jsx("option",{value:"DEFAULT",disabled:!0,children:"Select nationality"}),Object.entries(T).map(([t,o])=>e.jsx("option",{value:t,children:o},t))]})]}),e.jsx("button",{type:"submit",disabled:!h,className:`
                            w-full h-11 rounded-md font-bold text-sm transition
                            ${h?"bg-amber-300 hover:bg-amber-400 active:bg-amber-200 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}
                        `,children:"Next"})]})]})]})}function H(){return e.jsx(e.Fragment,{children:e.jsx($,{})})}const Y=C(H);export{Y as default};
