import{w as b}from "./with-props-JNWkkrjn.js";import{a as i,p as j,s as w}from "./chunk-D4RADZKF-DdSvw7tX.js";import{j as e}from "./jsx-runtime-D_zvdyIk.js";import{a as v}from "./barcodeAPI-jCDD8Npe.js";import{K as N}from "./index-Druiat5n.js";import{u as H}from "./useTranslation-DnilsLqi.js";import{R as k}from "./receipt-text-uISR2brj.js";import{B,F as R}from "./FloatingActionButtons-3zuONfQ9.js";import"./axiosInstance-CCaw23o5.js";import"./index-xsH4HHeE.js";import"./i18nInstance-CHFDjdcJ.js";import"./createLucideIcon-Cyt6UY_L.js";const C=()=>e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white",children:e.jsx("div",{className:"w-150 h-100",children:e.jsx(N,{src:"/loading/lottie_barcode.lottie",loop:!0,autoplay:!0})})});function D(){var d;const[o,x]=i.useState([]),[m,l]=i.useState(!0),n=j(),{t:r,i18n:a}=H(),u=w(),c=a.language;(d=u.state)==null||d.from,i.useEffect(()=>{async function t(){l(!0);try{const s=await v(c);x(s)}catch(s){console.error("Failed to load barcode history:",s)}finally{l(!1)}}t()},[c]);const p= t=>{n(`/products/${t}`)},g= t=>{n(`/reviews/add/${t}`)};if(m)return e.jsx(C,{});if(o.length===0)return e.jsx("div",{className:"p-4 text-center text-gray-400 text-sm",children:r("barcodeHistory.noHistory")});const h=o.length,f= t=>new Date(t).toLocaleString(a.language==="ko"?"ko-KR":a.language==="ja"?"ja-JP":"en-GB",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).replace(/\. /g,".").replace(".",". ");return e.jsxs("div",{className:"max-w-3xl mx-auto bg-white rounded-2xl shadow px-4 pt-4 pb-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-6 h-6 text-yellow-500"}),e.jsx("h2",{className:"text-xl font-semibold",children:r("barcodeHistory.title")})]}),e.jsx("ul",{className:"space-y-4",children:o.map((t, s)=>{const y=h-s;return e.jsxs("li",{className:"flex rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"flex-shrink-0 w-14 bg-white flex items-center justify-center text-yellow-500 font-extrabold text-xl select-none",children:y}),e.jsxs("div",{className:"flex-1 p-3 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>p(t.barcode),children:[e.jsx("img",{src:`https://myapp.peek-pick.click${t.productImageUrl}`,alt:t.productName,className:"w-14 h-14 object-cover rounded-md"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-black font-bold truncate",children:t.productName}),e.jsx("p",{className:"text-xs text-gray-600",children:f(t.regDate)})]})]}),t.isReview?e.jsx("button",{className:"bg-gray-200 text-gray-600 px-4 py-2 rounded w-full text-sm font-semibold border border-gray-200 cursor-not-allowed",disabled:!0,children:r("barcodeHistory.reviewAlready")}):e.jsx("button",{className:"bg-yellow-400 text-gray-800 hover:bg-yellow-400 px-4 py-2 rounded w-full text-sm font-semibold border border-white",onClick:()=>g(t.barcode),children:r("barcodeHistory.writeReview")})]})]},t.viewId)})}),e.jsx("div",{className:"mt-3 px-3 py-3 bg-gray-100 text-gray-600 rounded text-xs leading-tight text-left",children:r("barcodeHistory.footerNote")})]})}function L(){return e.jsxs("div",{children:[e.jsx(B,{}),e.jsx(R,{}),e.jsx(D,{}),e.jsx("div",{className:"h-15"})]})}const _=b(L);export{_ as default};
