import{w as B}from "./with-props-JNWkkrjn.js";import{p as S,a as n}from "./chunk-D4RADZKF-DdSvw7tX.js";import{j as e}from "./jsx-runtime-D_zvdyIk.js";import{u}from "./useQuery-CxabGwVz.js";import{r as I,l as A,a as F,b as O}from "./pointsAPI-Cz9Sup82.js";import{F as T,f as E}from "./index-DP0VIuDs.js";import{S as i}from "./sweetalert2.esm.all-9Qm2jZ7z.js";/* empty css                   */import{P as g}from "./points-A4FasJQU.js";import{P as K}from "./PaginationComponent-CiWrhgCU.js";import{B as q,F as M}from "./FloatingActionButtons-3zuONfQ9.js";import{L as D}from "./pointsLoading-rils2R6B.js";import{c as z}from "./createLucideIcon-Cyt6UY_L.js";import"./useBaseQuery-BTSvK_Q6.js";import"./removable-CGh8wCEh.js";import"./query-CjmfnAM3.js";import"./QueryClientProvider--V26__jT.js";import"./axiosInstance-CCaw23o5.js";import"./index-xsH4HHeE.js";import"./chevron-left-i71DKoJD.js";import"./chevron-right-WLYf1NvF.js";import"./index-Druiat5n.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]],$=z("shopping-bag",U);function _({products:t,onProductClick:a}){return e.jsx("div",{className:"container mx-auto",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-1",children:t.map(s=>e.jsxs("div",{onClick:()=>a(s),className:"cursor-pointer bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300 relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`https://myapp.peek-pick.click/points/${s.imgUrl}`,alt:s.item,className:"w-full h-28 object-cover rounded-t-lg"}),e.jsx("button",{className:"absolute top-2 right-2 bg-white bg-opacity-90 rounded-full p-1.5 shadow hover:bg-blue-100 transition",children:e.jsx(T,{icon:E,style:{color:"#6b7280"}})})]}),e.jsxs("div",{className:"p-3 flex flex-col text-center",children:[e.jsx("span",{className:"inline-block mb-1 px-2 py-0.5 rounded-full bg-gray-200 text-gray-700 text-xs font-medium",children:s.productType}),e.jsx("h6",{className:"text-sm font-medium mb-1 truncate",children:s.item}),e.jsxs("p",{className:"text-yellow-500 font-semibold text-sm",children:[s.price," points"]})]})]},s.pointstoreId))})})}function Q({product:t,onClose:a,onBuy:s}){const m=S();return e.jsx("div",{className:"fixed inset-0 bg-[rgba(0,0,0,0.3)] flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-[280px] p-4 animate-fade-in overflow-auto max-h-[60vh] text-sm sm:max-w-md sm:max-h-[80vh] sm:p-5 sm:text-base",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold truncate",children:t.item}),e.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 transition text-base sm:text-lg","aria-label":"Close",children:"âœ•"})]}),e.jsx("img",{src:`https://myapp.peek-pick.click/points/${t.imgUrl}`,alt:t.item,className:"w-full h-36 sm:h-44 object-cover rounded-lg mb-3"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 shadow-inner border border-gray-200 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"text-gray-700 font-bold text-lg",children:[t.price.toLocaleString()," pt"]}),e.jsx("span",{className:"inline-block bg-gray-200 text-gray-500 text-xs font-semibold px-2 py-0.5 rounded-full tracking-wide whitespace-nowrap select-none",children:t.productType})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"Description"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-line leading-snug text-sm",children:t.description})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 text-sm sm:text-base mt-4",children:[e.jsx("button",{onClick:async()=>{try{i.fire({title:"Processing purchase...",allowOutsideClick:!1,allowEscapeKey:!1,didOpen:()=>{i.showLoading()},customClass:{popup:"custom-popup",title:"custom-title",actions:"custom-actions",confirmButton:"custom-confirm-button"}}),(await s(t)).success?await i.fire({title:"Purchase completed.",icon:"success",confirmButtonText:"OK",customClass:{popup:"custom-popup",title:"custom-title",actions:"custom-actions",confirmButton:"custom-confirm-button"}}).then(()=>{a(),m("/points/store/list")}):await i.fire({title:"Purchase failed.",html:'<p style="font-size: 0.9rem; color: #f43f5e; margin-top: 8px;">Insufficient balance.</p>',icon:"error",confirmButtonText:"OK",customClass:{popup:"custom-popup",title:"custom-title",actions:"custom-actions",confirmButton:"custom-confirm-button"}})}catch{await i.fire({title:"An error occurred during the purchase.",icon:"error",confirmButtonText:"OK",customClass:{popup:"custom-popup",title:"custom-title",actions:"custom-actions",confirmButton:"custom-confirm-button"}})}},className:"flex items-center gap-1 rounded-md border border-yellow-500 bg-white px-3 py-1 text-sm font-medium text-yellow-500 shadow-sm hover:bg-blue-100 hover:text-blue-800 transition",children:"Buy"}),e.jsx("button",{onClick:a,className:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-3 py-1 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-100 hover:text-gray-800 transition",children:"Cancel"})]})]})})}function R(){const[t,a]=n.useState(0),s=10,m="pointstoreId",[r,f]=n.useState("ALL"),[l,d]=n.useState(null),[b,p]=n.useState(!1),{data:c,isLoading:y,isError:j}=u({queryKey:["points",t,s,r],queryFn:()=>A(t,s,m,r)}),{data:x,isLoading:w,isError:v}=u({queryKey:["pointDetail",l],queryFn:()=>l!==null?F(l):Promise.reject(),enabled:l!==null}),{data:N}=u({queryKey:["pointAmount"],queryFn:()=>O()}),[k,P]=n.useState(!0);if(n.useEffect(()=>{const o=setTimeout(()=>P(!1),1300);return()=>clearTimeout(o)},[]),y||w||k)return e.jsx(D,{});if(j||v||!c)return e.jsx("p",{className:"text-center p-4 text-red-500 text-base sm:text-lg",children:"Failed to load points data."});const L=async o=>{try{return await I(o.pointstoreId),p(!1),d(null),{success:!0}}catch{return{success:!1}}};return e.jsxs("div",{className:"max-w-3xl mx-auto bg-white rounded-2xl shadow px-4 pt-4 pb-6 relative space-y-4",children:[e.jsxs("div",{className:"absolute top-4 right-4 text-gray-600 font-semibold px-3 py-1 select-none text-sm",children:["ðŸª™",e.jsxs("span",{className:"font-bold",children:[N??0,"p"]})]}),e.jsx("div",{className:"flex justify-between items-center mb-4 mt-1.5",children:e.jsxs("h2",{className:"flex items-center gap-1 text-xl font-bold text-yellow-500 select-none leading-none",children:[e.jsx($,{className:"w-6 h-6 leading-none ml-1.5"}),e.jsx("span",{className:"leading-none text-black ml-1.5",children:"Point Store"})]})}),e.jsx("div",{className:"border-b border-gray-300 mb-6 px-4 sm:px-0",children:e.jsx("nav",{className:"flex justify-start sm:justify-center space-x-3 sm:space-x-6 overflow-x-auto no-scrollbar px-5 sm:px-0",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:["ALL",...Object.keys(g)].map(o=>{const C=o==="ALL"?"ALL":g[o],h=r===o;return e.jsxs("button",{onClick:()=>{f(o),a(0)},className:`relative pb-2 transition-colors duration-300 text-sm sm:text-sm whitespace-nowrap ${h?"font-bold text-yellow-400 border-b-2 border-yellow-400":"font-normal text-gray-500 hover:text-yellow-400"}`,children:[C,h&&e.jsx("span",{className:"absolute -bottom-0 left-0 right-0 h-0.5 bg-yellow-400"})]},o)})})}),e.jsxs("div",{children:[e.jsx(_,{products:c.content,onProductClick:o=>{d(o.pointstoreId),p(!0)}}),e.jsx(K,{currentPage:c.number,totalPages:c.totalPages,onPageChange:a,maxPageButtons:5}),b&&x&&e.jsx(Q,{product:x,onClose:()=>{p(!1),d(null)},onBuy:L})]}),e.jsx(q,{}),e.jsx(M,{})]})}const xe=B(R);export{xe as default};
