import{w as D}from "./with-props-JNWkkrjn.js";import{a as o,p as k,w as C}from "./chunk-D4RADZKF-DdSvw7tX.js";import{j as e}from "./jsx-runtime-D_zvdyIk.js";import{i as q,j as B}from "./inquiriesAPI-gt-yzMzF.js";import{I as S}from "./ImageModalComponent-Cw5E8d8F.js";import{a as E}from "./useInquiryMutation-D96ppYmq.js";import{I as T,a as L}from "./inquiry-AmjiLZEt.js";import{I as A}from "./inquiryLoading-DMYYepHY.js";import{S as f}from "./sweetalert2.esm.all-9Qm2jZ7z.js";/* empty css                   */import{u as w}from "./useTranslation-DnilsLqi.js";import{c as j}from "./createLucideIcon-Cyt6UY_L.js";import{C as M,H as $}from "./hourglass-BDOrxaAO.js";import{B as _,F as P}from "./FloatingActionButtons-3zuONfQ9.js";import"./axiosInstance-CCaw23o5.js";import"./index-xsH4HHeE.js";import"./proxy-B6a-3iLd.js";import"./QueryClientProvider--V26__jT.js";import"./useMutation-iBKtBQ4J.js";import"./mutation-CruqbX-z.js";import"./removable-CGh8wCEh.js";import"./index-Druiat5n.js";import"./i18nInstance-CHFDjdcJ.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],R=j("ellipsis-vertical",O);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],U=j("square-pen",F);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],W=j("trash",H),Y="https://myapp.peek-pick.click";function K({inquiry:t,navigate:n,isLoading:l}){var v,N;const{t:s}=w(),[c,u]=o.useState(null),[g,d]=o.useState(!1),i=o.useRef(null),y=E(),p=k();if(o.useEffect(()=>{const r=x=>{i.current&&!i.current.contains(x.target)&&d(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[]),l)return e.jsx(A,{});if(!t)return e.jsx("p",{className:"text-center p-4 text-red-500 text-base sm:text-lg",children:s("inquiry.loadFail","Failed to load inquiry data.")});const h=async()=>{if((await f.fire({title:s("inquiry.delete.confirmTitle","Are you sure you want to delete your inquiry?"),text:s("inquiry.delete.confirmText","Once deleted, the changes cannot be undone."),icon:"warning",showCancelButton:!0,confirmButtonText:s("inquiry.delete.confirmButton","Delete"),cancelButtonText:s("inquiry.delete.cancelButton","Cancel"),customClass:{popup:"custom-popup",title:"custom-title",actions:"custom-actions",confirmButton:"custom-confirm-button"}})).isConfirmed)try{await y.mutateAsync(t.inquiryId),await f.fire({title:s("inquiry.delete.success","Inquiry deleted successfully."),icon:"success",confirmButtonText:s("confirm","OK"),customClass:{popup:"custom-popup",title:"custom-title",actions:"custom-actions",confirmButton:"custom-confirm-button"}}),p("/inquiries/list")}catch(x){console.error("Delete failed:",x),await f.fire({title:s("inquiry.delete.fail","Failed to delete inquiry."),icon:"error",confirmButtonText:s("confirm","OK"),customClass:{popup:"custom-popup",title:"custom-title",actions:"custom-actions",confirmButton:"custom-confirm-button"}})}},a=s(`inquiry.types.${t.type}`,((v=T.find(r=>r.value===t.type))==null?void 0:v.label)??t.type),m=t.status==="ANSWERED",b=s(`inquiry.status.${t.status}`,L[t.status]);return e.jsxs("div",{className:"max-w-3xl mx-auto bg-white rounded-2xl shadow px-4 pt-4 pb-6 space-y-4 relative",children:[c&&e.jsx(S,{src:c,alt:s("inquiry.imageAlt","Attached Image"),onClose:()=>u(null)}),e.jsxs("div",{className:"flex items-center justify-between text-gray-600",children:[e.jsx("button",{onClick:()=>{window.history.length>1?p(-1):p("/inquiries/list")},className:"text-yellow-500 hover:text-yellow-600 p-1","aria-label":s("back","Back"),children:e.jsx("svg",{className:"w-6 h-6 inline-block",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("div",{className:"flex-1 text-center text-sm text-yellow-500 font-semibold truncate py-0.5",children:a}),e.jsxs("div",{className:"relative",ref:i,children:[e.jsx("button",{onClick:()=>d(r=>!r),className:"text-yellow-500 hover:text-yellow-600 p-1","aria-label":"More options",children:e.jsx(R,{className:"w-6 h-6"})}),g&&e.jsxs("div",{className:"absolute right-0 mt-2 w-28 bg-white border rounded shadow z-10",children:[e.jsxs("button",{className:"w-full px-3 py-2 text-left hover:bg-gray-100 flex items-center gap-2",onClick:()=>p(`/inquiries/${t.inquiryId}/edit`),children:[e.jsx(U,{className:"w-4 h-4"}),s("inquiry.edit.label","Edit")]}),e.jsxs("button",{className:"w-full px-3 py-2 text-left hover:bg-gray-100 text-red-600 flex items-center gap-2",onClick:h,children:[e.jsx(W,{className:"w-4 h-4"}),s("inquiry.delete.title","Delete")]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:`https://myapp.peek-pick.click/users/${t.userProfileImgUrl}`,alt:"Profile",className:"w-11 h-11 rounded-full object-cover border border-gray-300"}),e.jsx("span",{className:"font-semibold text-base ml-0.5",children:t.userNickname})]}),e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-3 py-1 font-semibold text-xs transition-colors ${m?"bg-yellow-400 hover:bg-yellow-500 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-500"}`,children:[m?e.jsx(M,{className:"w-3.5 h-3.5"}):e.jsx($,{className:"w-3.5 h-3.5"}),b]})]}),e.jsxs("div",{className:"flex flex-col items-end text-xs text-gray-500 mb-2.5 gap-1 leading-none",children:[e.jsxs("span",{children:[s("inquiry.postedOn","Posted on"),": ",e.jsx("span",{className:"bg-gray-100 px-0.5 py-0.5 text-gray-700",children:t.regDate.slice(0,16).replace("T"," ").replace(/-/g,".")})]}),t.modDate!==t.regDate&&e.jsxs("span",{children:[s("inquiry.updatedOn","Updated on"),": ",e.jsx("span",{className:"bg-gray-100 px-0.5 py-0.5 text-gray-700",children:t.modDate.slice(0,16).replace("T"," ").replace(/-/g,".")})]})]}),e.jsx("hr",{className:"border-t border-gray-200"}),e.jsx("div",{className:"text-gray-800 whitespace-pre-line leading-relaxed mt-4",children:t.content}),((N=t.imgUrls)==null?void 0:N.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"border-t border-dashed border-gray-300 my-4"}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-2",children:t.imgUrls.map(r=>{const x=r.startsWith("http")?r:`${Y}${r}`;return e.jsx("button",{onClick:()=>u(x),className:"relative w-full aspect-square overflow-hidden rounded-lg border border-gray-200 hover:shadow-sm transition-shadow",children:e.jsx("img",{src:x,alt:s("inquiry.imageAlt","Attached Image"),className:"w-full h-full object-cover",onError:I=>{I.currentTarget.src=""}})},r)})})]})]})}function V({inquiryId:t}){const{t:n}=w(),[l,s]=o.useState(null),[c,u]=o.useState(null),[g,d]=o.useState(!0),[i,y]=o.useState(null);o.useEffect(()=>{(async()=>{try{const a=await q(t);s((a==null?void 0:a.content)??null),u((a==null?void 0:a.regDate)??null)}catch(a){y(a.message??n("inquiry.answer.loadFail"))}finally{d(!1)}})()},[t,n]);const p=h=>{const a=new Date(h),m=b=>b.toString().padStart(2,"0");return`${a.getFullYear()}.${m(a.getMonth()+1)}.${m(a.getDate())} ${m(a.getHours())}:${m(a.getMinutes())}`};return g||i||!l?null:e.jsxs("div",{className:"max-w-3xl mx-auto bg-white rounded-2xl border-2 border-yellow-400 px-4 pt-4 pb-6 space-y-4 mt-6 shadow-sm",children:[e.jsxs("div",{className:"relative flex justify-between items-center mb-2.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:"/icons/admin_icon_img.png",alt:"profile",className:"w-11 h-11 pt-0.5 pl-1 rounded-full object-cover overflow-visible bg-yellow-500 border border-gray-300"}),e.jsx("span",{className:"font-semibold text-base ml-0.5",children:n("inquiry.answer.admin")})]}),e.jsx("div",{className:"absolute bottom-1 right-0 text-xs text-gray-500 gap-2 leading-none",children:e.jsxs("span",{children:[n("inquiry.answer.posted"),e.jsx("span",{className:"bg-gray-100 px-0.5 py-0.5 text-gray-700",children:c?p(c):"-"})]})})]}),e.jsx("hr",{className:"border-t border-gray-200"}),e.jsx("div",{className:"text-gray-800 whitespace-pre-line leading-relaxed mt-4",children:l})]})}function z(){const{id:t}=C(),n=k(),{t:l}=w(),[s,c]=o.useState(null),[u,g]=o.useState(!0);return o.useEffect(()=>{if(!t)return;const d=parseInt(t,10);Number.isNaN(d)||B(d).then(i=>{c(i.data)}).catch(i=>{console.error(i),f.fire({title:l("accessDenied"),icon:"error",confirmButtonText:l("confirmOKButtonText"),customClass:{popup:"custom-popup",title:"custom-title",actions:"custom-actions",confirmButton:"custom-confirm-button"}}).then(()=>n(-1))}).finally(()=>{g(!1)})},[t,n,l]),e.jsxs("div",{children:[e.jsx(_,{}),e.jsx(P,{}),e.jsx(K,{inquiry:s,navigate:n,isLoading:u}),s&&s.status==="ANSWERED"&&e.jsx(V,{inquiryId:s.inquiryId}),e.jsx("div",{className:"h-15"})]})}const ye=D(z);export{ye as default};
